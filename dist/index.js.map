{"version":3,"sources":["webpack://vella-pay/webpack/universalModuleDefinition","webpack://vella-pay/webpack/bootstrap","webpack://vella-pay/./src/index.js","webpack://vella-pay/./src/config.js"],"names":["root","factory","exports","module","define","amd","this","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","iframe","constructor","options","origin","URL","window","jQuery","script","document","createElement","src","head","appendChild","getElementById","id","body","loading","baseurl","elementId","publicKey","refLocation","config","_publicKey","init","registerElementId","ReadyState","makeNewFrame","initOptions","readyState","addEventListener","configs","frameId","generateFrameId","host","location","href","objParams","frame","newURL","URLSearchParams","toString","widgetsource","ifrm","setAttribute","assign","style","background","border","overflow","visibility","margin","padding","position","left","top","width","height","marginwidth","marginheight","frameBorder","vspace","mountFrame","parentNode","insertBefore","alert","text","possible","charAt","Math","floor","random","addMessageListener","func","attachEvent","onError","callback","res","data","error","ok","code","onSuccess","response","closeWidget","close","onClose","display","remove"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"vella-pay\"] = factory();\n\telse\n\t\troot[\"vella-pay\"] = factory();\n})(this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","import * as CONFIG from \"./config\";\n\nvar iframe = \"\";\n\nexport default class VellaCheckout {\n  constructor(key, options) {\n    var origin = CONFIG.BASE_URL;\n\n    const URL = `${origin}/checkout`;\n\n    CONFIG.loadWidgetPresets();\n\n    iframe = \"\";\n    let loading = false;\n    let baseurl = URL;\n    let elementId = \"vew-widget\";\n    let publicKey = \"\";\n    let refLocation = \"\";\n\n    this.config = {\n      _publicKey: key,\n      options,\n    };\n\n    this.init = function () {\n      if (this.config._publicKey == null) return;\n      else publicKey = this.config._publicKey;\n      registerElementId(this.config.options);\n\n      if (ReadyState) makeNewFrame(this.config);\n\n      //listenForCloseEvent();\n      return this;\n    };\n\n    const registerElementId = function (options) {\n      const initOptions = options;\n      if (initOptions && initOptions.elementId) {\n        elementId = initOptions.elementId;\n      }\n      refLocation = document.getElementById(elementId);\n    };\n\n    const ReadyState = function () {\n      if (document.readyState == \"complete\") return true;\n      else if (document.readyState == \"loading\") return false;\n      else {\n        return document.addEventListener(\"DOMContentLoaded\", () => true);\n      }\n    };\n\n    const makeNewFrame = function (configs) {\n      loading = true;\n      var frameId = generateFrameId();\n      var host = document.location.href;\n\n      let objParams = {\n        frame: frameId,\n        key: configs._publicKey,\n        host: host,\n        mode: \"popup\", // page, true, false\n        ...configs.options,\n      };\n\n      const newURL = new URLSearchParams(objParams).toString();\n\n      const widgetsource = `${baseurl}?${newURL}`;\n\n      // Setup Iframe\n      var ifrm = document.createElement(\"IFRAME\");\n      ifrm.setAttribute(\"src\", widgetsource);\n      ifrm.setAttribute(\n        \"allow\",\n        \"geolocation *;  clipboard-read; clipboard-write\"\n      );\n      ifrm.setAttribute(\"allowtransparency\", true);\n\n      var style = {\n        \"z-index\": \"999999\",\n        // display: \"none\",\n        background: \"rgba(0, 0, 0, 0.004)\",\n        border: \"0px none transparent\",\n        overflow: \"hidden\",\n        visibility: \"visible\",\n        margin: \"0px\",\n        padding: \"0px\",\n        position: \"fixed\",\n        left: \"0px\",\n        top: \"0px\",\n        width: \"100%\",\n        height: \"100%\",\n      };\n\n      Object.assign(ifrm.style, style);\n      ifrm.marginwidth = \"0\";\n      ifrm.marginheight = \"0\";\n      ifrm.frameBorder = \"0\";\n      ifrm.vspace = \"0\";\n      ifrm.id = ifrm.name = frameId;\n\n      mountFrame(ifrm);\n\n      try {\n        //  recordFrame()\n      } catch (err) {}\n    };\n    const mountFrame = function (ifrm) {\n      if (document.getElementById(elementId) == null) {\n        alert(`Element with id: ${elementId} not found`);\n        return;\n      }\n      // Place iframe on DOM\n      refLocation.parentNode.insertBefore(ifrm, refLocation);\n      // save a reference\n      iframe = ifrm;\n    };\n\n    const generateFrameId = function () {\n      for (\n        var text = \"\",\n          possible =\n            \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\",\n          i = 0;\n        i < 5;\n        i++\n      )\n        text += possible.charAt(Math.floor(Math.random() * possible.length));\n      return text;\n    };\n\n    const addMessageListener = function (func) {\n      if (window.addEventListener) {\n        window.addEventListener(\"message\", func, false);\n      } else {\n        window.attachEvent(\"onmessage\", func);\n      }\n    };\n    const listenForCloseEvent = function () {\n      var closeEvent = function (e) {\n        // A better validation should be made to ensure that the event is coming from cclan.\n        // Otherwise, code from other authors could unknowingly close the modal.\n        if (e.origin == origin) {\n          if (e.data === \"vella-close\") {\n            close();\n            onClose();\n          } else if (e.data === \"vella-frame-loaded\") {\n            // _ loaded(); no event like loaded on Iframe\n          }\n        }\n      };\n      addMessageListener(closeEvent);\n    };\n    this.onError = function (callback) {\n      const errorMessage = (res) => {\n        if (\n          res &&\n          res.data &&\n          typeof res.data == \"object\" &&\n          res.origin == origin\n        ) {\n          let error = res.data;\n          if (!error.ok && error.code >= 400) {\n            return callback(error.data);\n          }\n        }\n      };\n      addMessageListener(errorMessage);\n    };\n    this.onSuccess = function (callback) {\n      const successMessage = (res) => {\n        if (\n          res &&\n          res.data &&\n          typeof res.data == \"object\" &&\n          res.origin == origin\n        ) {\n          const response = res.data;\n          if (response.ok && response.code == 200) {\n            return callback(res.data.data);\n          }\n        }\n      };\n      addMessageListener(successMessage);\n    };\n\n    this.closeWidget = function () {\n      close();\n    };\n\n    const onClose = function (callback) {\n      const closeMessage = (res) => {\n        if (\n          res &&\n          res.data &&\n          typeof res.data == \"object\" &&\n          res.origin == origin\n        ) {\n          const response = res.data;\n          if (response.ok && response.code == 100) {\n            close();\n            return callback(res.data.data);\n          }\n        }\n      };\n      addMessageListener(closeMessage);\n    };\n\n    const close = function () {\n      iframe.style.display = \"none\";\n      iframe.remove();\n    };\n\n    this.onClose = onClose;\n  }\n}\n","export const BASE_URL = 'https://checkout.vella.finance';\n\nexport const loadWidgetPresets = () => {\n    if (!window.jQuery) {\n        var script = document.createElement(\"script\");\n        script.src = \"https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js\";\n        document.head.appendChild(script);\n    }\n\n    if (document.getElementById(\"vew-widget\") == null) {\n        var c = document.createElement(\"div\");\n        c.id = \"vew-widget\";\n        document.body.appendChild(c);\n    }\n}"],"sourceRoot":""}